{% extends "base.html" %}

{% block title %}Admin Dashboard - CoursePDF Extractor{% endblock %}

{% block main_class %}admin-main{% endblock %}

{% block content %}
<div class="admin-container">
    <h1 class="admin-title">Admin Dashboard</h1>

    <!-- Upload Course Structure Section -->
    <div class="content-section">
        <h2>Upload Course Structure</h2>
        <div class="upload-section">
            <form id="uploadForm" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="courseLevel">Course Level:</label>
                    <select id="courseLevel" name="course_level" required>
                        <option value="">Select Level</option>
                        <option value="Certificate">Certificate</option>
                        <option value="Foundation">Foundation</option>
                        <option value="Diploma">Diploma</option>
                        <option value="Pre-University">Pre-University</option>
                        <option value="Degree">Degree</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="courseStructure">Course Structure Excel File:</label>
                    <input type="file" id="courseStructure" name="file" accept=".xlsx,.xls" required>
                </div>
                <button type="submit" class="btn btn-primary">Upload and Process</button>
            </form>
            
            <!-- Add this div for status messages -->
            <div id="uploadStatus" class="mt-3"></div>
        </div>
    </div>

<!-- Create tabs for each table -->
<div class="admin-tabs">
    <button class="tab-button active" onclick="openTab(event, 'departments')">Departments</button>
    <button class="tab-button" onclick="openTab(event, 'lecturers')">Lecturers</button>
    <button class="tab-button" onclick="openTab(event, 'persons')">Persons</button>
    <button class="tab-button" onclick="openTab(event, 'programs')">Programs</button>
    <button class="tab-button" onclick="openTab(event, 'subjects')">Subjects</button>
</div>
<div class = "tab-content-container">
<!-- Content for each tab -->
<div id="departments" class="tab-content" style="display:none;">
    <h2>Departments</h2>
    <div class="table-actions">
        <input type="checkbox" class="select-all" data-table="departmentsTable">
        <label>Select All</label>
        <button class="delete-selected" data-table="departments">Delete Selected</button>
    </div>
    <table id="departmentsTable">
        <thead>
            <tr>
                <th></th>
                <th>Department Code</th>
                <th>Department Name</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for department in departments %}
            <tr>
                <td><input type="checkbox" class="record-checkbox" data-id="{{ department.department_code }}"></td>
                <td>{{ department.department_code }}</td>
                <td>{{ department.department_name }}</td>
                <td class="action-buttons">
                    <button class="edit-btn" onclick="editRecord('departments', '{{ department.department_code }}')">
                        <i class="fas fa-pencil-alt"></i>
                    </button>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div id="lecturers" class="tab-content" style="display:none;">
    <h2>Lecturers</h2>
    <div class="table-actions">
        <input type="checkbox" class="select-all" data-table="lecturersTable">
        <label>Select All</label>
        <button class="delete-selected" data-table="lecturers">Delete Selected</button>
    </div>
    <table id="lecturersTable">
        <thead>
            <tr>
                <th></th>
                <th>ID</th>
                <th>Name</th>
                <th>Email</th>
                <th>Level</th>
                <th>Hourly Rate</th>
                <th>Department</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for lecturer in lecturers %}
            <tr>
                <td><input type="checkbox" class="record-checkbox" data-id="{{ lecturer.lecturer_id }}"></td>
                <td>{{ lecturer.lecturer_id }}</td>
                <td>{{ lecturer.lecturer_name }}</td>
                <td>{{ lecturer.email_address }}</td>
                <td>{{ lecturer.level }}</td>
                <td>{{ lecturer.hourly_rate }}</td>
                <td>{{ lecturer.department_code }}</td>
                <td class="action-buttons">
                    <button class="edit-btn" onclick="editRecord('lecturers', '{{ lecturer.lecturer_id }}')">
                        <i class="fas fa-pencil-alt"></i>
                    </button>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div id="persons" class="tab-content" style="display:none;">
    <h2>Persons</h2>
    <div class="table-actions">
        <input type="checkbox" class="select-all" data-table="personsTable">
        <label>Select All</label>
        <button class="delete-selected" data-table="persons">Delete Selected</button>
    </div>
    <table id="personsTable">
        <thead>
            <tr>
                <th></th>
                <th>User ID</th>
                <th>Email</th>
                <th>Department</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for person in persons %}
            <tr>
                <td><input type="checkbox" class="record-checkbox" data-id="{{ person.user_id }}"></td>
                <td>{{ person.user_id }}</td>
                <td>{{ person.email }}</td>
                <td>{{ person.department_code }}</td>
                <td class="action-buttons">
                    <button class="edit-btn" onclick="editRecord('persons', '{{ person.user_id }}')">
                        <i class="fas fa-pencil-alt"></i>
                    </button>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div id="programs" class="tab-content" style="display:none;">
    <h2>Programs</h2>
    <div class="table-actions">
        <input type="checkbox" class="select-all" data-table="programsTable">
        <label>Select All</label>
        <button class="delete-selected" data-table="programs">Delete Selected</button>
    </div>
    <table id="programsTable">
        <thead>
            <tr>
                <th></th>
                <th>Program Code</th>
                <th>Program Name</th>
                <th>Level</th>
                <th>Department</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for program in programs %}
            <tr>
                <td><input type="checkbox" class="record-checkbox" data-id="{{ program.program_code }}"></td>
                <td>{{ program.program_code }}</td>
                <td>{{ program.program_name }}</td>
                <td>{{ program.level }}</td>
                <td>{{ program.department_code }}</td>
                <td class="action-buttons">
                    <button class="edit-btn" onclick="editRecord('programs', '{{ program.program_code }}')">
                        <i class="fas fa-pencil-alt"></i>
                    </button>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div id="subjects" class="tab-content" style="display:none;">
    <h2>Subjects</h2>
    <div class="table-actions">
        <input type="checkbox" class="select-all" data-table="subjectsTable">
        <label>Select All</label>
        <button class="delete-selected" data-table="subjects">Delete Selected</button>
    </div>
    <div class="table-responsive">
        <table id="subjectsTable">
            <thead>
                <tr>
                    <th></th>
                    <th>Subject Code</th>
                    <th>Subject Title</th>
                    <th>Course Level</th>
                    <th>Lecture Hours</th>
                    <th>Tutorial Hours</th>
                    <th>Practical Hours</th>
                    <th>Blended Hours</th>
                    <th>Lecture Weeks</th>
                    <th>Tutorial Weeks</th>
                    <th>Practical Weeks</th>
                    <th>Blended Weeks</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for subject in subjects %}
                <tr>
                    <td><input type="checkbox" class="record-checkbox" data-id="{{ subject.subject_code }}"></td>
                    <td>{{ subject.subject_code }}</td>
                    <td>{{ subject.subject_title }}</td>
                    <td>{{ subject.course_level }}</td>
                    <td>{{ subject.lecture_hours }}</td>
                    <td>{{ subject.tutorial_hours }}</td>
                    <td>{{ subject.practical_hours }}</td>
                    <td>{{ subject.blended_hours }}</td>
                    <td>{{ subject.lecture_weeks }}</td>
                    <td>{{ subject.tutorial_weeks }}</td>
                    <td>{{ subject.practical_weeks }}</td>
                    <td>{{ subject.blended_weeks }}</td>
                    <td class="action-buttons">
                        <button class="edit-btn" onclick="editRecord('subjects', '{{ subject.subject_code }}')">
                            <i class="fas fa-pencil-alt"></i>
                        </button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
</div>
<div id="editModal" class="modal">
    <div class="modal-content">
        <span class="modal-close">&times;</span>
        <h2>Edit Record</h2>
        <form id="editForm" class="edit-form">
            <div id="editFormFields"></div>
            <button type="submit" class="save-btn">Save Changes</button>
        </form>
    </div>
</div>

{% endblock %}

{% block scripts %}
{{ super() }}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="{{ url_for('static', filename='js/admin.js') }}"></script>
{% endblock %}
